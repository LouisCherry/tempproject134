package com.epoint.auditproject.auditproject.action;

import com.alibaba.fastjson.JSONObject;
import com.epoint.sm2util.SM2Utils;
import com.epoint.sm2util.Util;

import java.io.IOException;

public class JNScanCodePageActionTest 
{
    public static void main(String[] args) throws IOException {
        String resultParmas = "{\"head\":{\"message\":\"接口调用成功\",\"status\":0},\"data\":{\"certData\":\"04775BC4681965C0151644888FCE94E37AF1295C9515E8FD75C9193F6AD12B0EB6889FA16A9609D029F85A3AB712836C2F6085360A745A1177CCE8637A0EB2B4C9371DBA18B602E2C74EDCD8AC9EA59CBF993200854C28E351378310398EBEFCB6C9EFBF56444FC49FDAAEFFEED0EEB77A066D3EBDBABE1DE620BAACA1774FA6826C74C0C6819AA12D6F1D1C680739D3FE41EDBA04A572B3E5AFA0BE6D6CC84D7DAAAEB68C2363AA0CE7EA1BCF9C0D371A633090C50EB81D935D9B04EF7B388B714EE8813B8ED5197577DE3CD0182805C6249E2F8A84730B200A0399300502CDF1494A042F616600C9E7A564B19632F437F6F5A49367BB148138E06A70815B4981053303FB1FC153F5E0A08F5D1F9D50A818E9BE922F5C64E9D07E7A9A339A329EFA44D6C11BACB295B4714B1EADE7FDF2A4ED473EBF566CAF0F0F5C669F52A1CB9689D4D5FC63136679AA58F0B5F3A9A92DAF503663EF64C04CBEE7FF36725F07EC379EFA7A2307DF7F4D3AB90F19E1ED0AA274617F54C21417D1F0C90E3F01E9C1065EECF7F04D791F8805C4FC23FF3A1CAA4360CB4DE6940052CDDD10C5BCCC3F16280357E8396759C27D03A2F8DCAFC1F3B4435479F782656C555D816949CFA3AF\"}} ";
        String privatekey = "00be74f417ec9e92fa1532d91c5a011d57b9d2ed88343b0dd716e5d3648f9b92d9";
        JSONObject resultjson = JSONObject.parseObject(resultParmas);
        JSONObject datajson = resultjson.getJSONObject("data");
        byte[] decrypt;
        decrypt = SM2Utils.decrypt(Util.hexToByte(privatekey),
                Util.hexToByte(datajson.getString("certData")));
        // 将字节数组转为字符串
        String backresult = new String(decrypt, "utf-8");
        System.out.println(backresult);
    }

}
